// SPDX-License-Identifier: (GPL-2.0 OR MIT)
/*
 * Copyright (C) 2020 Synaptics Incorporated
 *
 * Author: Benson Gui <begu@synaptics.com>
 */

/dts-v1/;

/memreserve/ 0x7f000000 0x01000000;

#include <dt-bindings/gpio/gpio.h>

#include "vs640.dtsi"

/ {
	model = "Synaptics VS640 LK02";
	compatible = "syna,vs640-lk02", "syna,vs640";

	cpus {
		cpu@0 {
			cpu0-supply = <&vcpu>;
		};
	};

	chosen {
		stdout-path = "serial0:115200n8";
	};

	memory {
		device_type = "memory";
		reg = <0 0x01000000 0 0x7f000000>;
	};

	ion {
		compatible = "syna,ion-berlin-heaps";
		pool-num = <2>;
		reg-names = "NonSecure-NC", "Secure";
		reg = <0 0x7f000000 0 0x00800000>,
		      <0 0x7f800000 0 0x00800000>;
		attributes-num-per-pool = <2>;
		pool-attributes = <0x00000105 0x00000F3A 0x00000102 0x00000F3D>;
	};

	sdhci1_pwrseq: sdhci1-pwrseq {
		compatible = "mmc-pwrseq-simple";
		reset-gpios = <&porta 1 GPIO_ACTIVE_LOW>;
	};

	bt-dev {
		compatible = "syna,bt-dev";
		pinctrl-0 = <&bt_pmux>;
		pinctrl-names = "default";
		dev_name = "bt-dev";
		gpio_reset = <&portd 13 GPIO_ACTIVE_HIGH>;
	};
};

&pinctrl {
	i2c0_pmux: i2c0-pmux {
		groups = "TW0_SCL", "TW0_SDA";
		function = "tw0";
		drive-strength = <7>;
	};

	i2c1_pmux: i2c1-pmux {
		groups = "SDIO0_CDn", "SDIO0_WP";
		function = "tw1a";
		drive-strength = <7>;
	};

	scrd_pmux: scrd-pmux {
		groups = "SCRD0_RST", "SCRD0_DCLK", "SPI1_SS2n", "SPI1_SS3n", "SCRD0_DIO", "SCRD0_CRD_PRES";
		function = "scrd0";
	};

	uart2_pmux: uart2-pmux {
		groups = "STS0_CLK", "STS0_SOP", "STS0_SD", "STS0_VALD";
		function = "uart2b";
	};
};

&sm_pinctrl {
	i2c2_pmux: i2c2-pmux {
		groups = "SM_TW2_SCL", "SM_TW2_SDA";
		function = "tw2";
		drive-strength = <7>;
	};

	i2c3_pmux: i2c3-pmux {
		groups = "SM_TW3_SCL", "SM_TW3_SDA";
		function = "tw3";
		drive-strength = <7>;
	};

	bt_pmux: bt-pmux {
		groups = "SM_SPI2_SDO";
		function = "gpio";
		drive-strength = <3>;
	};
};

&avio_pinctrl {
	spdifo_pmux: spdifo-pmux {
		groups = "SPDIFO";
		function = "spdifo";
	};

	wifi_pmux: wifi_pmux {
		groups = "I2S3_DO";
		function = "gpio";
	};
};

&sdhci0 {
	status = "okay";
	sdclkdl-dc = /bits/ 8 <26>;
	mmc-ddr-1_8v;
	mmc-hs200-1_8v;
	mmc-hs400-1_8v;
	mmc-hs400-enhanced-strobe;
	dll-calibration;
	dll-delay-offset = <300>;
};

&sdhci1 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&wifi_pmux>;
	no-sd;
	no-mmc;
	non-removable;
	initial-voltage = /bits/ 8 <1>;
	sdclkdl-dc = /bits/ 8 <75>;
	pad-sp = /bits/ 8 <12>;
	pad-sn = /bits/ 8 <12>;
	drv-strength = /bits/ 8 <3>;
	mmc-pwrseq = <&sdhci1_pwrseq>;
	mode1-tune;
	keep-power-in-suspend;
};

&uart0 {
	status = "okay";
};

&uart2 {
	pinctrl-0 = <&uart2_pmux>;
	pinctrl-names = "default";
	status = "okay";
};

&i2c0 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&i2c0_pmux>;
};

&i2c1 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&i2c1_pmux>;

	vcpu: regulator@61 {
		compatible = "halo,hl7593";
		regulator-name = "vcpu";
		regulator-min-microvolt = <700000>;
		regulator-max-microvolt = <987500>;
		regulator-always-on;
		regulator-boot-on;
		halo,vsel-state-high;
		halo,vsel-step = <1>;
		reg = <0x61>;
	};
};

&i2c2 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&i2c2_pmux>;
};

&i2c3 {
	status = "okay";
	pinctrl-names = "default";
	pinctrl-0 = <&i2c3_pmux>;
};

&ephy {
	status = "okay";
};

&mdio0 {
	phy0: ethernet-phy@0 {
		reg = <0>;
		interrupt-parent = <&sic>;
		interrupts = <30>;
		ephy = <&ephy>;
		eee-broken-100tx;
	};
};

&gmac0 {
	status = "okay";
	phy-handle = <&phy0>;
	phy-mode = "mii";
};

&usb0 {
	status = "okay";
};

&usb_phy0 {
	status = "okay";
};

&h1 {
	status = "okay";
};

&vxg {
	status = "okay";
};

&shm {
	status = "okay";
};

&bm {
	status = "okay";
};

&tsp {
	status = "okay";
};

&sm {
	status = "okay";
};

&ir {
	status = "okay";
};

&npu {
	status = "okay";
};

&avio {
	status = "okay";
};

&gpu {
	status = "okay";
};

&aout {
	status = "okay";
	pinctrl-0 = <&spdifo_pmux>;
	pinctrl-names = "default";
};

&dmic {
	status = "okay";
};

&vs640_pcm {
	status = "okay";
};

&vs640_asoc {
	status = "okay";

	dummy_dmic: dummy-dmic {
		status = "okay";
		stream-name = "dummy-dmic";
		link-name = "dummy-dmic";
		cpu-node = <&dmic>;
		codec-name = "snd-soc-dummy";
		codec-dai-name = "snd-soc-dummy-dai";
		platform-node = <&vs640_pcm>;
	};
};

&nsk {
	status = "okay";
};

&ovp {
	status = "okay";
};

&usim {
	status = "okay";
	pinctrl-0 = <&scrd_pmux>;
	pinctrl-names = "default";
	voltcfg1-gpios = <&portb 2 GPIO_ACTIVE_HIGH>;
	voltcfg2-gpios = <&portb 1 GPIO_ACTIVE_HIGH>;
	cmdvcc-gpios = <&porta 17 GPIO_ACTIVE_HIGH>;
	chipsel-gpios = <&porta 16 GPIO_ACTIVE_HIGH>;
	ext-volt-cfg-div = <0 1 3>; /* <VOLT_CFG_1_8V VOLT_CFG_3_3V VOLT_CFG_5_0V> */
};

&vpp {
	status = "okay";
};

&fb {
	status = "okay";
};

&cec {
	status = "okay";
};

&dsp0 {
	status = "okay";
};

&dsp1 {
	status = "okay";
};

&pwm0 {
	status = "okay";
};

&ifcp {
	status = "okay";
};

&axi_meter {
	status = "okay";
};
